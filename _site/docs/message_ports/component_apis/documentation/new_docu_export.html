<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">


  
     <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" type="text/css"><!--Import materialize.css-->
    <link type="text/css" rel="stylesheet" href="/assets/materialize/css/materialize.min.css" media="screen,projection"><!--Import custom css including overrides -->
    <link type="text/css" rel="stylesheet" href="/assets/css/custom.css" media="screen,projection"><!--Let browser know website is optimized for mobile-->
    <link type="text/css" rel="stylesheet" href="/assets/css/custom_callout.css" media="screen,projection"><!--Let browser know website is optimized for mobile-->

    <link href="/assets/prism/prism.css" rel="stylesheet" />
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <!--<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Your awesome title" />--></head>
<body>
	<header>
		<nav class="z-depth-0 adoscript_nav	">
			<div class="nav-wrapper">
				<a href="#" class="brand-logo">NEW_DOCU_EXPORT</a>
				<ul id="nav-mobile" class="right hide-on-med-and-down">
				</ul>
			</div>
		</nav>
		<ul id="slide-out"
			class="sidenav sidenav-fixed z-depth-0 adoscript_sidenav">
		<li class="logo"><a id="logo-container" href="/" class="brand-logo">
            <object id="front-page-logo" type="image/png" data="/assets/images/adoxx_logo.png">Your browser does not support SVG</object></a></li>
		<!-- <li class="version"><a href="#" data-target="version-dropdown" class="dropdown-trigger">
            ADOxx 1.5
            <svg class="caret" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></a><ul id="version-dropdown" class="dropdown-content" tabindex="0">
            <li tabindex="0"><a>ADOxx 1.3</a></li>
            <li tabindex="0"><a>ADOxx 1.5</a></li>
            <li tabindex="0"><a href="#">ADOxx 1.7</a></li>
          </ul>
          
        </li>	 -->		
			
        <li class="search">
          	  <div id="search-searchbar"></div>
        </li>
        <li class="divider"></li>
        
		</ul>
		<a href="#" data-target="slide-out" class="sidenav-trigger adoscript_menu_trigger" ><i
			class="material-icons adoscript_menu_open">menu</i></a>
	</header>

	<main>
	<div class="container adoscript_container">
	
	
<div id="search-hits-container" class="callout">
<div class="search-result-header">Search results <div id="stats-container"></div></div>
  <div id="search-hits"></div>
</div>



    <span class="new badge grey" data-badge-caption="ADOxx 1.5"></span>
  
    <span class="new badge grey" data-badge-caption="ADOxx 1.3"></span>
  


	
	
	
	<p>NEW_DOCU_EXPORT starts the documentation generation for a given set of models.</p>

<h1 id="syntax">Syntax:</h1>

<pre class="line-numbers"><code class="language-adoscript">
CC "Documentation" NEW_DOCU_EXPORT	strValue Source 
									[ filename:strValue ] [ filetype: sgml | xml ]
									[ linebreak:strValue ]
									[ NoInterRefWarnings ] [ silentmode ]
									[ NoRecordRows ] [ strong-reference-check [: 1|0] ]
									[ get-offline-target-instances ]
									[ with-interref-target-ids[: 1|0] ]
									[ maxw:intValue ] [ maxh:intValue ] .


Source :		SourceModels | SourceRecord .

SourceModels :	[ modelids:strValue ] [ refmodelids:strValue ] .

SourceRecord :	objid:id attrid:id .

NoInterRefWarnings :	no-interref-warnings[: 1|0] |
						no-interref-warnings:attribute:attrName .

NoRecordRows :	no-record-rows[: 1|0] |
				no-record-rows:attributes:strValue .

#--&gt; RESULT ecode:intValue 
			canceled:intValue 
			gfxscaling:strValue .

</code></pre>

<h1 id="parameters">Parameters:</h1>

<table>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">&lt;main_parameter&gt;</code></td>
      <td>strValue, the name of the menuentry for the documentation generation in the documentation menu has to be specified.</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">filename</code></td>
      <td>strValue, string value containing the target file name and path</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">filetype</code></td>
      <td>sgml</td>
      <td>xml, the type of the export file; default is sgml. When filetype:xml is specified, the export file is in XML format. This is similar to SGML. However, all tags are closed and the encoding is always UTF8. (The tags which are not closed in SGML are &lt;SPOT&gt; and &lt;ATTRSPOT&gt;.)</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">linebreak</code></td>
      <td>strValue, used for changing the linebreak characters.</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">silentmode</code></td>
      <td>modifier if specified, all messages at the UI are suppressed while documentation is generated.</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">strong-reference-check</code></td>
      <td>if set, the export component checks for any exported reference (INTERREF entry) which is valid on core level, whether the referenced model also exists on database level. By default such references do not appear as broken, although following such a reference (= loading the referenced model) is not possible. The default behavior is exactly the behavior of the rich client. The references on Core level become up-to-date only on updating of the model list.</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">get-offline-target-instances</code></td>
      <td>modifier, if specified, for references to instances the VALUE tag in the SGML file is written with an attribute OFFLINETARGETINSTANCEID.</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">with-interref-target-ids</code></td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">maxw</code></td>
      <td>intValue, specifies the maximum width of generated graphics (in pixels). When the generated model graphics would actually be larger, the scaling factor is reduced automatically, so that the generated graphics has at most the specified maximum width.</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">maxh</code></td>
      <td>intValue, specifies the maximum height of generated graphics (in pixels). When the generated model graphics would actually be larger, the scaling factor is reduced automatically, so that the generated graphics has at most the specified maximum height.</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">modelids</code></td>
      <td>strValue, contains the IDs of all main models that should be exported, separated by blank spaces.</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">refmodelids</code></td>
      <td>strValue, contains the IDs of all referenced models that should be exported, separated by blank spaces.</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">objid</code></td>
      <td>id</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">attrid</code></td>
      <td>id</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">no-interref-warnings</code></td>
      <td>if present suppresses the error messages caused by dangling references it the exporting is being performed with the option “with referenced models”. Instead of passing a bool value directly, you can also specify the name of an integer attribute of the <em>LibraryMetaData</em> class, whose value is interpreted then.</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">no-record-rows</code></td>
      <td>if specified, record rows are not exported. This may be used for performance enhancement, when record contents are not needed momentarily. Alternatively you can specify a list of record attribute IDs, for which no rows are exported. The content of a single records can be exported by specifying the containing object (objid) and the record attribute (attrid) as source. Note that the related model must be loaded.</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h1 id="returns">Returns:</h1>

<table>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">ecode</code></td>
      <td>intValue, is 1 in case of success or 0 otherwise.</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">canceled</code></td>
      <td>0</td>
      <td>1, if ecode != 0 and the generation has been canceled by the user, canceled has the value 1, otherwise 0.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">gfxscaling</code></td>
      <td>strValue, gives you information on if and how automitic downsizing has been applied. It is a string containing an array value which contains the actual scaling factors for each generated graphics file. Each element of that array represents one graphics file and is again an array, consisting of three elements: a model id, a dpi value and a scaling factor. The scaling factor normally is 1.0 for each generated graphics file. If a graphics file could not be generated with the desired resolution, automatic downsizing is applied, using a smaller scaling factor.</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h1 id="remarks">Remarks:</h1>

<p>When the file type is XML, since version 1.3 by default no linebreaks are written between tags, while for older versions and still for SGML newline (“\n”) characters are written, so that the export file can easier be read using a normal text editor. The linebreak string can be changed with linebreak, e.g. linebreak:”” or linebreak:”\n”.</p>

<p>When modelids or refmodelids is not specified the model lists that have been evaluated the last time the export dialog has been opened will be used. To avoid this, pass an empty string (modelids:”” or refmodelids:””).<br />
When only modelids and not refmodelids has been specified, no referenced model list of the last export dialog will be used.</p>

<p>The value “{{4711, 96, 0.8}, {4711, 72,1.0}}” for gfxscaling means that two graphics files have been generated for model id 4711. The first one should have been generated with 96 dpi, but has been downsized with scaling factor 0.8. The second graphics file has successfully been generated with 72 dpi. Unfortunately, gfxscaling is not an array but a string containing an array value. To convert that string into a real array value, write SET gfxscale:(VAL (“(“ + gfxscale + “)”)).</p>

<h1 id="see-also">See Also:</h1>

<p><a href="docu_export.html" title="DOCU_EXPORT">DOCU_EXPORT</a></p>

<p>Example 1:</p>

<p>The following lets the user select models in the export dialog. Then two documentations are generated with the call NEW_DOCU_EXPORT: one for <strong>html</strong> and one for <strong>rtf</strong> documentation.</p>
<pre class="line-numbers"><code class="language-adoscript">

CC "Documentation" EXEC_EXPORTDIALOG "RTF, HTML &amp; ADL Export"
    filedescription:"HTML/RTF/ADL Files" fileextension:"**.adl"
IF (ecode &lt;= 0) {
    CC "AdoScript" INFOBOX "Export canceled"
    EXIT
}
SET basename:(copy(filename, 0, LEN filename - 4))

CC "Documentation" NEW_DOCU_EXPORT "HTML-Generierung..."
    filename:(basename+".html")
    modelids:(selmodelids) refmodelids:(refmodelids)
IF (ecode != 0) {
    IF (canceled = 1) {
        CC "AdoScript" INFOBOX "Export canceled"
    } ELSE {
        CC "AdoScript" INFOBOX "An error occured."
    }
    EXIT
}
CC "Documentation" NEW_DOCU_EXPORT "RTF-Generierung..." 
    filename:(basename+".rtf")
    modelids:(selmodelids) refmodelids:(refmodelids)
IF (ecode != 0) {
    IF (canceled = 1) {
        CC "AdoScript" INFOBOX "Export canceled"
    } ELSE {
        CC "AdoScript" INFOBOX "An error occured."
    }
    EXIT
}


</code></pre>


</div>
	
	
	
	</main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <!-- <h2 class="footer-heading">Your awesome title</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Your awesome title</li><li><a class="u-email" href="mailto:your-email@example.com">your-email@example.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/jekyll"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">jekyll</span></a></li><li><a href="https://www.twitter.com/jekyllrb"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">jekyllrb</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>
      </div>
    </div> -->

  </div>

</footer>
<script type="text/javascript"
		src="/assets/jquery/jquery-3.3.1.min.js">
	</script>
	<!-- Including InstantSearch.js library and styling -->
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch-theme-algolia.min.css">
<!-- load custom search styles -->
<link type="text/css" rel="stylesheet" href="/assets/css/custom_search.css" media="screen,projection">

<script>
// Instanciating InstantSearch.js with Algolia credentials
const search = instantsearch({
  appId: 'QOEMVL4S23',
  indexName: 'adoscript_api_docu',
  apiKey: '5186f57e5a3ae3be1ee2d0a0d99335cb',
  searchFunction: function(helper) {
	    var searchResults = $('#search-hits');
	    var searchResultContainer = $('#search-hits-container');
	    if (helper.state.query === '') {
	      // empty query string -> hide the search results & abort the search
	      searchResults.hide();
	      searchResultContainer.hide();
	      return;
	    }
	    // perform the regular search & display the search results
	    helper.search();
	    searchResults.show();
	    searchResultContainer.show();
	  }
});

// Adding searchbar and results widgets
search.addWidget(
  instantsearch.widgets.searchBox({
    container: '#search-searchbar',
    placeholder: 'Search documentation...',
    poweredBy: true, // This is required if you're on the free Community plan
    reset : true,
    cssClasses: {
        root: 'adoscript_searchbox',
        input: 'adoscript_search_input',
      }
  })
);
search.addWidget(
  instantsearch.widgets.hits({
    container: '#search-hits',
    templates: {
        item: function(hit) {
          if (hit._highlightResult.title && hit._highlightResult.content) {
            const content = hit._highlightResult.content.value;
            const title = hit._highlightResult.title.value;
            var version_html = "";
            var tags = hit.tags;
            tags.sort(function(x, y) {
            	return (x < y) ? 1 : (x > y) ? -1 : 0;
		    });
            for (var i = 0; i < tags.length; i++) {
                version_html+='<span class="adoscript_version new badge grey" style="font-size: 0.6em;" data-badge-caption="ADOxx '+hit.tags[i]+'"></span>';
            }
            return `
              <bold><a class="adoscript_hit_title" href="${hit.url}">${title}</a>${version_html}</bold>
              <p class="adoscript_hit_content">${content}</p>
              <p class="adoscript_type">Type: ${hit.categories[0]}</p>
            `;
          }
        }
      },
      cssClasses: {
          root: 'collection',
          item: 'collection-item',
          empty: 'collection-item'
        }
  })
);
search.addWidget(
		  instantsearch.widgets.stats({
		    container: '#stats-container'
		  })
		);

// Starting the search
search.start();

$('.ais-search-box--reset').on('click tap', function() {
	$('.ais-search-box--input')
    .val('')
    .focus()
    .trigger({ type: 'keypress', which: 13 });
	search.helper.setQuery('').search();
});

</script>

	<script type="text/javascript" src="/assets/materialize/js/materialize.js"></script>
	<script type="text/javascript" src="/sidebar.js"></script>
	
	
	<script type="text/javascript">
	
	
		$(document).ready(function() {
				
			function getNestedChildren(arr, parent) {
			    var out = []
			    for(var i in arr) {
			        if(arr[i].parent == parent) {
			            var children = getNestedChildren(arr, arr[i].id)

			            if(children.length) {
			                arr[i].children = children
			            }
			            out.push(arr[i])
			        }
			    }
			    return out
			}
			
			function getHTMLTree ( a, str ) {
				//sort by folder, files first, then folders
				a.sort(function(x, y) {
					var xType = x.isFolder;
					var yType = y.isFolder; 
			        // true values first
			        //return (xType === yType)? 0 : xType? -1 : 1;
			        // false values first
			        return (xType === yType)? 0 : xType? 1 : -1;
			    });
			    for (var i = 0; i < a.length; i++) {	
			        //this is a folder, as there are children: FIXME: could also be done through isFolder property
			        if (a[i].children && a[i].children.length) {
			        	var cssActive = "";
			        	var iconClass = "keyboard_arrow_right";
			        	if (localStorage.getItem(a[i].url)) {
			        		cssActive = "active";
			        		iconClass = "keyboard_arrow_down";
			        	}
			        	str += '<li class="no-padding"><ul class="collapsible collapsible-accordion"><li class="folder '+cssActive+'" id="'+a[i].url+'"><a class="collapsible-header waves-effect">'+a[i].title+'<i class="material-icons">'+iconClass+'</i></a><div class="collapsible-body"><ul>';
			        	str += getHTMLTree( a[i].children, '');
			        	str += '</ul></div></li></ul></li>';			        	
			        }
			        //this is a file part
			        else {
			        	if (a[i].url == '/docs/message_ports/component_apis/documentation/new_docu_export.html') {
				            str += '<li class="active"><a class="adoscript_docu waves-effect" href="'+a[i].url+'">'+a[i].title+'</a></li>'
							
			        	}
			        	else {
				            str += '<li><a class="adoscript_docu waves-effect" href="'+a[i].url+'">'+a[i].title+'</a></li>'

			        	}
			        }
			    }
			    return str;
			}
			
			//sort the folder in hierarchical tree, starting from sublevel /docs
			var hierarchicalFolders = getNestedChildren(sidebar, "/docs");			
			$(".sidenav").append(getHTMLTree( hierarchicalFolders, ''));
			
			
			function openFolder () {
				//change the icon
				this.el.childNodes["0"].childNodes["0"].childNodes[1].innerHTML="keyboard_arrow_down";
				//store state open in localStorage
				//console.log(this.el.children["0"].getAttribute('id'));
				localStorage.setItem(this.el.children["0"].getAttribute('id'), true);
			}
			
			function closeFolder () {
				//change the icon
				this.el.childNodes["0"].childNodes["0"].childNodes[1].innerHTML="keyboard_arrow_right";
				localStorage.removeItem(this.el.children["0"].getAttribute('id'));

			}
			//this opens all folders
			var openElement = $("a[href$='/docs/message_ports/component_apis/documentation/new_docu_export.html']")
			var parentElementsLI = openElement.parents('li.folder');
			parentElementsLI.addClass("active");
	
			
			//change the handle for each icon
			parentElementsLI.each(function( index ) {
			  $(this).children("a.collapsible-header").children("i.material-icons").html ("keyboard_arrow_down");
			});
			

			
			$('.sidenav').sidenav();
			$('.dropdown-trigger').dropdown();
			$('.collapsible').collapsible({
				onOpenStart : openFolder,
				onCloseStart : closeFolder
		    });
			$('a.adoscript_docu').click(function() {
			  //replaced, not required
			});
			
			//scroll to position
			var screenPosition = openElement.get( 0 ).getBoundingClientRect();
			$('.sidenav').scrollTop(screenPosition.top-300);
		});
	</script>
    <script src="/assets/prism/prism.js"></script>
  
	
</body>

</html>
